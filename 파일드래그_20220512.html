<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<style>
div {margin: 0; padding: 0; box-sizing: border-box; border-radius: 10px;}
.backGround {width: 1200px; height: 1000px; /*background: #acf;*/ padding: 50px; }
#fileArea {width: 800px; height: 300px; border: 1px solid black; margin: 0 auto; background: #fff;}
#fileArea p {font-size: 85px; width: 100%; text-align: center; font-weight: bold; color: #ddd;}
#textArea {width: 800px; height: 300px; border: 1px solid black; margin: 15px auto; background: #fff; overflow: auto;}
#uploadArea {width: 800px; height: 200px; border: 1px solid black; margin: 15px auto; background: #fff; overflow: auto;}
.fileDataUl {padding : 0;}
.fileDataUl>li {list-style : none;}
.starSpan {/*left: 1100px; position: absolute;*/ font-size: 100px;}
.starSpan:hover {cursor: pointer; color : aqua;}
</style>
</head>
<body>
    <div class="backGround">
        <div id="fileArea">
            <p>파일 드래그 영역</p>
        </div>
        <div id="textArea"></div>
        <div id="uploadArea"></div>     
    </div>
<script language="javascript">
var dragFileList = new Array();
var dragTarget = null;

document.body.onload = function() {
    appendStarSpans();
    addEventArea();
}

function readDragFiles(e) {
    var files = e.dataTransfer.files.length > 0 && e.dataTransfer.files;

    //console.log(files);
    dragFileList.push(files);
    resetAreaStyle(fileArea);

    if (files) {
        var fileUl = document.createElement('ul');
        var fileInputUl = document.createElement('ul');
        var fileInputLi = document.createElement('li');
        var fileInput = document.createElement('input');

        fileInput.type = 'file';

        if (files.length > 1) {
            fileInput.multiple = true;
        }

        fileInput.files = files;

        fileInputLi.appendChild(fileInput);
        fileInputUl.appendChild(fileInputLi);

        for (var i=0; i<files.length; i++) {
            var file = files[i];
            var fileLi = document.createElement('li');
            var fileDataUl = makeFileDataUl(file);

            fileLi.appendChild(fileDataUl);
            fileUl.appendChild(fileLi);            
        }

        textArea.appendChild(fileUl);
        uploadArea.appendChild(fileInputUl);
    } else {
        alert('파일이 아닙니다.');
    }
}

function makeFileDataUl(file) {
    var fileDataUl = document.createElement('ul');
    var fileInfo = [file.name, file.type, file.size];

    fileDataUl.className = 'fileDataUl';

    for (var i=0; i<fileInfo.length; i++) {
        var fileDataLi = document.createElement('li');
        var fileDataB = document.createElement('b');
        var fileDataSpan = document.createElement('span');

        switch(i) {
            case 0 : fileDataB.innerText = '파일명 : ';
                break;
            case 1 : fileDataB.innerText = '파일유형 : ';
                break;
            case 2 : fileDataB.innerText = '파일크기 : ';
                break;
        }

        fileDataSpan.innerText = fileInfo[i];

        fileDataLi.appendChild(fileDataB);
        fileDataLi.appendChild(fileDataSpan);
        fileDataUl.appendChild(fileDataLi);
    }

    return fileDataUl;
}

function changeAreaStyle(area) {
    area.style.background = '#9bf';

    if (area == fileArea) {
        area.children[0].style.color = '#fff';
    }
    
}

function resetAreaStyle(area) {
    area.style.background = '#fff';

    if (area == fileArea) {
        area.children[0].style.color = '#ddd';
    }
}

function appendStarSpans() {
    var body = document.body;

    for (var i=0; i<10; i++) {
        var span = document.createElement('span');
        span.className = 'starSpan';
        
        if (i%2 == 0) {
            span.innerText = '☆'
        } else {
            span.innerText = '★'
        }
        
        body.insertBefore(span, body.children[0]);
    }

    addEventStarSpan();
}

function addEventStarSpan() {
    var starSpans = document.getElementsByClassName('starSpan');

    for (var i=0; i<starSpans.length; i++) {
    var starSpan = starSpans[i];

    starSpan.draggable = true;
    starSpan.ondblclick = function() {
        var body = document.body;

        alert('☆★☆★☆★☆★☆★');
        body.insertBefore(this, body.children[0]);
    }
    }
}

function addEventArea() {
    var fileArea = document.getElementById('fileArea');
    var textArea = document.getElementById('textArea');
    var uploadArea = document.getElementById('uploadArea');
    var areas = [fileArea, textArea, uploadArea];

    window.ondragstart = function(e) {
        dragTarget = e.target;
    }

    for (var i=0; i<areas.length; i++) {
    var area = areas[i];

    area.ondragover = function(e) {
        e.preventDefault();
        changeAreaStyle(this);
    }

    area.ondragleave = function(e) {
        e.preventDefault();
        resetAreaStyle(this);
    }

    area.ondrop = function(e) {
        e.preventDefault();
        resetAreaStyle(this);
        
        if (this == fileArea) {
            readDragFiles(e);
        } else {
            if(dragTarget) {
                this.appendChild(dragTarget);
            }
        }
    }
    }
}

//https://inpa.tistory.com/entry/%EB%93%9C%EB%9E%98%EA%B7%B8-%EC%95%A4-%EB%93%9C%EB%A1%AD-Drag-Drop-%EA%B8%B0%EB%8A%A5
</script>
</body>
</html>